env:
  - RIAK_VERSION=default RSPEC_ARGS="--tag '~riak:2.0'"
  - RIAK_VERSION=2.0.0pre5 RIAK_RELEASE=2.0 RSPEC_ARGS=""
rvm:
  - 1.9.3
matrix:
  allow_failures:
    - rvm: jruby-head
    - rvm: jruby-18mode
    - rvm: jruby-19mode
    - rvm: rbx-18mode
    - rvm: rbx-19mode
services:
  - riak
bundler_args: --without=guard
before_install:
  - ./install_riak.sh
script:
  - "bundle exec rspec ${RSPEC_ARGS}"
before_script:
  - ! 'echo "pb_port: 8087" > spec/support/test_client.yml'
  - ! 'echo "root: .riaktest" > spec/support/test_server.yml'
  - ! 'echo "source: /usr/sbin" >> spec/support/test_server.yml'
  - "ulimit -n 2048"
